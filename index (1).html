<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Funcionários</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin: 0;
            padding: 0;
            color: #333;
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: linear-gradient(135deg, #1c1e21 0%, #343a40 100%);
            color: #fff;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
            transition: width 0.3s;
        }

        .sidebar h1 {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            color: #0fbcf9;
        }

        .sidebar h2 {
            font-size: 1.3em;
            margin-bottom: 20px;
            text-align: center;
            color: #0fbcf9;
        }

        .sidebar a {
            color: #fff;
            text-decoration: none;
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            transition: background 0.3s, color 0.3s;
            font-size: 1.2em;
        }

        .sidebar a.active,
        .sidebar a:hover {
            background: #0fbcf9;
            color: #fff;
        }

        .sidebar a i {
            margin-right: 10px;
        }

        .logo {
            margin-left: 70px;
            margin-bottom: 20px;
        }

        main {
            flex: 1;
            padding: 20px;
            margin-left: 280px;
            overflow-y: auto;
            height: 100vh;
            background: #fff;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
            transition: margin-left 0.3s;
        }

        .section {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            display: none;
            transition: opacity 0.3s;
        }

        .section.active {
            display: block;
            opacity: 1;
        }

        h1,
        h2 {
            text-align: center;
            color: #2b2b2b;
            margin-bottom: 20px;
        }

        fieldset {
            border: none;
            margin-bottom: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        legend {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2b2b2b;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2b2b2b;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1em;
        }

        textarea {
            resize: vertical;
        }

        button {
            display: block;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #0fbcf9 0%, #0d8eca 100%);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s;
        }

        button:hover {
            background: linear-gradient(135deg, #0d8eca 0%, #0b6ba8 100%);
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            white-space: nowrap;
        }

        th {
            background-color: #1c1e21;
            color: #fff;
        }

        td img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .action-buttons button {
            padding: 6px 10px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            transition: background 0.3s;
        }

        .edit-button {
            background-color: #ffc107;
            color: #333;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: #fff;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        .filter-container {
            margin-bottom: 20px;
        }

        .filter-container input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1em;
        }

        .dashboard-stat {
            background: linear-gradient(135deg, #1c1e21 0%, #343a40 100%);
            color: #fff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 10px;
            text-align: center;
            flex: 1;
            min-width: 200px;
            transition: transform 0.3s;
        }

        .dashboard-stat:hover {
            transform: translateY(-10px);
        }

        .dashboard-stat h3 {
            margin: 0;
            font-size: 1.8em;
        }

        .dashboard-stat p {
            font-size: 1.2em;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .dashboard-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .chart-wrapper {
            flex: 1;
            min-width: 300px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #0fbcf9;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: fadein 0.5s;
        }

        @keyframes fadein {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            th,
            td {
                font-size: 14px;
            }

            button {
                font-size: 14px;
                padding: 10px;
            }

            .sidebar {
                width: 100%;
                height: auto;
                box-shadow: none;
                position: static;
            }

            main {
                padding: 10px;
                margin-left: 0;
                width: 100%;
            }

            .dashboard-row {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <div class="sidebar">
        <img class="logo" src="https://i.imgur.com/wkuQHpM.png" alt="logo" width="80px">
        <h1>Nexus Soluções & Tecnologia</h1>
        <h2>Menu</h2>
        <a href="#" id="show-dashboard" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="#" id="show-form"><i class="fas fa-user-plus"></i> Cadastro de Funcionário</a>
        <a href="#" id="show-list"><i class="fas fa-users"></i> Lista de Funcionários</a>
        <a href="#" id="show-form"><i class="fas fa-chart-line"></i> Cadastro de Projetos</a>
    </div>

    <main>
        <div id="dashboard-section" class="section active">
            <h1>Dashboard</h1>
            <div class="dashboard-row">
                <div class="dashboard-stat" id="total-employees">
                    <h3>Total de Funcionários</h3>
                    <p>0</p>
                </div>
                <div class="dashboard-stat" id="new-employees">
                    <h3>Novos Funcionários</h3>
                    <ul id="new-employees-list"></ul>
                </div>
            </div>
            <div class="dashboard-row">
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="gender-distribution-chart"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="position-distribution-chart"></canvas>
                    </div>
                </div>
            </div>
            <div class="dashboard-row">
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="department-distribution-chart"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="age-distribution-chart"></canvas>
                    </div>
                </div>
            </div>
            <div class="dashboard-row">
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="status-distribution-chart"></canvas>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <div class="chart-container">
                        <canvas id="salary-distribution-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="form-section" class="section">
            <h1>Cadastro de Funcionário</h1>
            <form id="employee-form">
                <fieldset>
                    <legend>Informações Pessoais</legend>
                    <label for="foto">Foto:</label>
                    <input type="file" id="foto" accept="image/*">

                    <label for="matricula">Matrícula:</label>
                    <input type="text" id="matricula" required>

                    <label for="nome">Nome:</label>
                    <input type="text" id="nome" required>

                    <label for="dataNascimento">Data de Nascimento:</label>
                    <input type="date" id="dataNascimento" required>

                    <label for="genero">Gênero:</label>
                    <select id="genero" required>
                        <option value="">Selecione</option>
                        <option value="masculino">Masculino</option>
                        <option value="feminino">Feminino</option>
                        <option value="outro">Outro</option>
                    </select>

                    <label for="nacionalidade">Nacionalidade:</label>
                    <input type="text" id="nacionalidade" required>

                    <label for="email">E-mail:</label>
                    <input type="email" id="email" required>

                    <label for="telefone">Telefone:</label>
                    <input type="tel" id="telefone" required>

                    <label for="endereco">Endereço:</label>
                    <textarea id="endereco" rows="3" required></textarea>
                </fieldset>

                <fieldset>
                    <legend>Informações de Trabalho</legend>
                    <label for="cargo">Cargo:</label>
                    <input type="text" id="cargo" required>

                    <label for="departamento">Departamento:</label>
                    <input type="text" id="departamento" required>

                    <label for="salario">Salário:</label>
                    <input type="number" id="salario" step="0.01" required>

                    <label for="dataAdmissao">Data de Admissão:</label>
                    <input type="date" id="dataAdmissao" required>

                    <label for="status">Status:</label>
                    <select id="status" required>
                        <option value="">Selecione</option>
                        <option value="ativo">Ativo</option>
                        <option value="inativo">Inativo</option>
                    </select>
                </fieldset>

                <fieldset>
                    <legend>Documentos Pessoais</legend>
                    <label for="cpf">CPF:</label>
                    <input type="text" id="cpf" required>

                    <label for="rg">RG:</label>
                    <input type="text" id="rg" required>

                    <label for="ctps">CTPS:</label>
                    <input type="text" id="ctps" required>

                    <label for="pis">PIS:</label>
                    <input type="text" id="pis" required>
                </fieldset>

                <fieldset>
                    <legend>Contratos</legend>
                    <label for="contratoTrabalho">Contrato de Trabalho:</label>
                    <input type="file" id="contratoTrabalho" accept=".pdf,.doc,.docx">

                    <label for="contratoExperiencia">Contrato de Experiência:</label>
                    <input type="file" id="contratoExperiencia" accept=".pdf,.doc,.docx">
                </fieldset>

                <fieldset>
                    <legend>Formação Acadêmica</legend>
                    <label for="nivelEscolaridade">Nível de Escolaridade:</label>
                    <select id="nivelEscolaridade" required>
                        <option value="">Selecione</option>
                        <option value="fundamental">Fundamental</option>
                        <option value="medio">Médio</option>
                        <option value="tecnico">Técnico</option>
                        <option value="graduacao">Graduação</option>
                        <option value="posGraduacao">Pós-Graduação</option>
                        <option value="mestrado">Mestrado</option>
                        <option value="doutorado">Doutorado</option>
                    </select>

                    <label for="curso">Curso:</label>
                    <input type="text" id="curso" required>

                    <label for="instituicao">Instituição:</label>
                    <input type="text" id="instituicao" required>

                    <label for="anoConclusao">Ano de Conclusão:</label>
                    <input type="number" id="anoConclusao" required>
                </fieldset>

                <fieldset>
                    <legend>Dados Adicionais</legend>
                    <label for="banco">Banco:</label>
                    <input type="text" id="banco" required>

                    <label for="agencia">Agência:</label>
                    <input type="text" id="agencia" required>

                    <label for="conta">Conta:</label>
                    <input type="text" id="conta" required>
                </fieldset>

                <button type="submit" id="submit-button">Cadastrar Funcionário</button>
                <button type="button" id="update-button" style="display: none;">Salvar</button>
            </form>
        </div>

        <div id="list-section" class="section">
            <h1>Lista de Funcionário</h1>
            <div class="filter-container">
                <label for="filter-matricula">Filtrar por Matrícula:</label>
                <input type="text" id="filter-matricula">
            </div>
            <div class="table-container">
                <table id="employee-list">
                    <thead>
                        <tr>
                            <th>Foto</th>
                            <th>Matrícula</th>
                            <th>Nome</th>
                            <th>Data de Nascimento</th>
                            <th>Gênero</th>
                            <th>Nacionalidade</th>
                            <th>E-mail</th>
                            <th>Telefone</th>
                            <th>Endereço</th>
                            <th>Cargo</th>
                            <th>Departamento</th>
                            <th>Salário</th>
                            <th>Data de Admissão</th>
                            <th>Status</th>
                            <th>Documentos</th>
                            <th>Contratos</th>
                            <th>Formação Acadêmica</th>
                            <th>Dados Adicionais</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Funcionários serão adicionados aqui via JavaScript -->
                    </tbody>
                </table>
            </div>
            </div>

            <div id="list-section" class="section">
                <h1>Cadastro de Projetos</h1>
                <div class="filter-container">
                    <label for="filter-matricula">Lista de Projetos:</label>
                    <input type="text" id="filter-matricula">
                </div>
                <div class="table-container">
                    <table id="employee-list">
                        <thead>
                            <tr>
                                <th>Foto</th>
                                <th>Matrícula</th>
                                <th>Nome</th>
                                <th>Data de Nascimento</th>
                                <th>Gênero</th>
                                <th>Nacionalidade</th>
                                <th>E-mail</th>
                                
                            </tr>
                        </thead>
                    </table>
                </div>
                </div>





    </main>

    <div class="notification" id="notification"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let editingEmployeeId = null;

        document.getElementById('show-dashboard').addEventListener('click', function () {
            showSection('dashboard-section');
        });

        document.getElementById('show-form').addEventListener('click', function () {
            showSection('form-section');
        });

        document.getElementById('show-list').addEventListener('click', function () {
            showSection('list-section');
        });

        function showSection(sectionId) {
            document.querySelectorAll('main > div').forEach(function (section) {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.sidebar a').forEach(function (link) {
                link.classList.remove('active');
            });
            document.querySelector(`#show-${sectionId.split('-')[0]}`).classList.add('active');
        }

        document.getElementById('employee-form').addEventListener('submit', function (event) {
            event.preventDefault();
            if (editingEmployeeId) {
                updateEmployee(editingEmployeeId);
            } else {
                createEmployee();
            }
        });

        document.getElementById('update-button').addEventListener('click', function () {
            updateEmployee(editingEmployeeId);
        });

        function createEmployee() {
            const employee = getEmployeeFormData();
            if (!employee) return;

            fetch('http://localhost:8080/api/funcionarios', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(employee)
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(error => { throw new Error(error.message || 'Erro ao salvar funcionário'); });
                }
                return response.json();
            })
            .then(savedEmployee => {
                addEmployeeToTable(savedEmployee);
                updateDashboard();
                resetForm();
                showSection('list-section');
                showNotification('Funcionário cadastrado com sucesso!');
            })
            .catch(error => {
                console.error(error);
                showNotification(`Erro ao salvar funcionário: ${error.message}`, 'error');
            });
        }

        function updateEmployee(id) {
            const employee = getEmployeeFormData();
            if (!employee) return;

            fetch('http://localhost:8080/api/funcionarios/${id}', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(employee)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erro ao atualizar funcionário');
                }
                return response.json();
            })
            .then(() => {
                loadEmployees();
                resetForm();
                showSection('list-section');
                showNotification('Funcionário atualizado com sucesso!');
            })
            .catch(error => {
                console.error(error);
                showNotification('Erro ao atualizar funcionário', 'error');
            });
        }

        function getEmployeeFormData() {
            const foto = document.getElementById('foto').files[0];
            const matricula = document.getElementById('matricula').value;
            const nome = document.getElementById('nome').value;
            const dataNascimento = document.getElementById('dataNascimento').value;
            const genero = document.getElementById('genero').value;
            const nacionalidade = document.getElementById('nacionalidade').value;
            const email = document.getElementById('email').value;
            const telefone = document.getElementById('telefone').value;
            const endereco = document.getElementById('endereco').value;
            const cargo = document.getElementById('cargo').value;
            const departamento = document.getElementById('departamento').value;
            const salario = document.getElementById('salario').value;
            const dataAdmissao = document.getElementById('dataAdmissao').value;
            const status = document.getElementById('status').value;
            const cpf = document.getElementById('cpf').value;
            const rg = document.getElementById('rg').value;
            const ctps = document.getElementById('ctps').value;
            const pis = document.getElementById('pis').value;
            const contratoTrabalho = document.getElementById('contratoTrabalho').files[0];
            const contratoExperiencia = document.getElementById('contratoExperiencia').files[0];
            const nivelEscolaridade = document.getElementById('nivelEscolaridade').value;
            const curso = document.getElementById('curso').value;
            const instituicao = document.getElementById('instituicao').value;
            const anoConclusao = document.getElementById('anoConclusao').value;
            const banco = document.getElementById('banco').value;
            const agencia = document.getElementById('agencia').value;
            const conta = document.getElementById('conta').value;

            if (matricula === '' || nome === '' || dataNascimento === '' || genero === '' || nacionalidade === '' || email === '' || telefone === '' || endereco === '' || cargo === '' || departamento === '' || salario === '' || dataAdmissao === '' || status === '' || cpf === '' || rg === '' || ctps === '' || pis === '' || nivelEscolaridade === '' || curso === '' || instituicao === '' || anoConclusao === '' || banco === '' || agencia === '' || conta === '') {
                alert('Por favor, preencha todos os campos.');
                return null;
            }

            return {
                foto: foto ? URL.createObjectURL(foto) : 'https://via.placeholder.com/50',
                matricula,
                nome,
                dataNascimento,
                genero,
                nacionalidade,
                email,
                telefone,
                endereco,
                cargo,
                departamento,
                salario,
                dataAdmissao,
                status,
                cpf,
                rg,
                ctps,
                pis,
                contratoTrabalho: contratoTrabalho ? URL.createObjectURL(contratoTrabalho) : '',
                contratoExperiencia: contratoExperiencia ? URL.createObjectURL(contratoExperiencia) : '',
                nivelEscolaridade,
                curso,
                instituicao,
                anoConclusao,
                banco,
                agencia,
                conta
            };
        }

        function addEmployeeToTable(employee) {
            const tableBody = document.querySelector('#employee-list tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><img src="${employee.foto}" alt="Foto de ${employee.nome}"></td>
                <td>${employee.matricula}</td>
                <td>${employee.nome}</td>
                <td>${employee.dataNascimento}</td>
                <td>${employee.genero}</td>
                <td>${employee.nacionalidade}</td>
                <td>${employee.email}</td>
                <td>${employee.telefone}</td>
                <td>${employee.endereco}</td>
                <td>${employee.cargo}</td>
                <td>${employee.departamento}</td>
                <td>${formatCurrency(employee.salario)}</td>
                <td>${employee.dataAdmissao}</td>
                <td>${employee.status}</td>
                <td>
                    <ul>
                        <li>CPF: ${employee.cpf}</li>
                        <li>RG: ${employee.rg}</li>
                        <li>CTPS: ${employee.ctps}</li>
                        <li>PIS: ${employee.pis}</li>
                    </ul>
                </td>
                <td>
                    <ul>
                        <li><a href="${employee.contratoTrabalho}" target="_blank">Contrato de Trabalho</a></li>
                        <li><a href="${employee.contratoExperiencia}" target="_blank">Contrato de Experiência</a></li>
                    </ul>
                </td>
                <td>
                    <ul>
                        <li>Nível: ${employee.nivelEscolaridade}</li>
                        <li>Curso: ${employee.curso}</li>
                        <li>Instituição: ${employee.instituicao}</li>
                        <li>Ano de Conclusão: ${employee.anoConclusao}</li>
                    </ul>
                </td>
                <td>
                    <ul>
                        <li>Banco: ${employee.banco}</li>
                        <li>Agência: ${employee.agencia}</li>
                        <li>Conta: ${employee.conta}</li>
                    </ul>
                </td>
                <td class="action-buttons">
                    <button class="edit-button" onclick="editEmployee(${employee.id})">Editar</button>
                    <button class="delete-button" onclick="deleteEmployee(${employee.id})">Excluir</button>
                </td>
            `;
            tableBody.appendChild(row);
        }

        function formatCurrency(value) {
            return `R$ ${parseFloat(value).toFixed(2).replace('.', ',')}`;
        }

        function loadEmployees() {
            fetch('http://localhost:8080/api/funcionarios')
                .then(response => response.json())
                .then(employees => {
                    document.querySelector('#employee-list tbody').innerHTML = '';
                    employees.forEach(employee => addEmployeeToTable(employee));
                    updateDashboard();
                })
                .catch(error => console.error('Erro ao carregar funcionários:', error));
        }

        function editEmployee(id) {
            fetch('http://localhost:8080/api/funcionarios/${id}')
                .then(response => response.json())
                .then(employee => {
                    document.getElementById('matricula').value = employee.matricula;
                    document.getElementById('nome').value = employee.nome;
                    document.getElementById('dataNascimento').value = employee.dataNascimento;
                    document.getElementById('genero').value = employee.genero;
                    document.getElementById('nacionalidade').value = employee.nacionalidade;
                    document.getElementById('email').value = employee.email;
                    document.getElementById('telefone').value = employee.telefone;
                    document.getElementById('endereco').value = employee.endereco;
                    document.getElementById('cargo').value = employee.cargo;
                    document.getElementById('departamento').value = employee.departamento;
                    document.getElementById('salario').value = employee.salario;
                    document.getElementById('dataAdmissao').value = employee.dataAdmissao;
                    document.getElementById('status').value = employee.status;
                    document.getElementById('cpf').value = employee.cpf;
                    document.getElementById('rg').value = employee.rg;
                    document.getElementById('ctps').value = employee.ctps;
                    document.getElementById('pis').value = employee.pis;
                    document.getElementById('nivelEscolaridade').value = employee.nivelEscolaridade;
                    document.getElementById('curso').value = employee.curso;
                    document.getElementById('instituicao').value = employee.instituicao;
                    document.getElementById('anoConclusao').value = employee.anoConclusao;
                    document.getElementById('banco').value = employee.banco;
                    document.getElementById('agencia').value = employee.agencia;
                    document.getElementById('conta').value = employee.conta;

                    document.getElementById('submit-button').style.display = 'none';
                    document.getElementById('update-button').style.display = 'block';

                    editingEmployeeId = id;
                    showSection('form-section');
                })
                .catch(error => console.error('Erro ao carregar funcionário:', error));
        }

        function deleteEmployee(id) {
            if (confirm('Tem certeza que deseja excluir este funcionário?')) {
                fetch('http://localhost:8080/api/funcionarios/{id}', {
                    method: 'DELETE',
                })
                .then(() => {
                    loadEmployees();
                    showNotification('Funcionário excluído com sucesso!');
                })
                .catch(error => console.error('Erro ao excluir funcionário:', error));
            }
        }

        function updateDashboard() {
            fetch('http://localhost:8080/api/funcionarios')
                .then(response => response.json())
                .then(employees => {
                    document.getElementById('total-employees').querySelector('p').textContent = employees.length;

                    const newEmployeesList = document.getElementById('new-employees-list');
                    newEmployeesList.innerHTML = '';
                    employees.slice(-5).forEach(employee => {
                        const listItem = document.createElement('li');
                        listItem.textContent = employee.nome;
                        newEmployeesList.appendChild(listItem);
                    });

                    updateCharts(employees);
                })
                .catch(error => console.error('Erro ao atualizar o dashboard:', error));
        }

        function updateCharts(employees) {
            const genderCounts = employees.reduce((acc, emp) => {
                acc[emp.genero] = (acc[emp.genero] || 0) + 1;
                return acc;
            }, {});

            const positionCounts = employees.reduce((acc, emp) => {
                acc[emp.cargo] = (acc[emp.cargo] || 0) + 1;
                return acc;
            }, {});

            const departmentCounts = employees.reduce((acc, emp) => {
                acc[emp.departamento] = (acc[emp.departamento] || 0) + 1;
                return acc;
            }, {});

            const ageCounts = employees.reduce((acc, emp) => {
                const age = new Date().getFullYear() - new Date(emp.dataNascimento).getFullYear();
                const ageRange = `${Math.floor(age / 10) * 10} - ${Math.floor(age / 10) * 10 + 9}`;
                acc[ageRange] = (acc[ageRange] || 0) + 1;
                return acc;
            }, {});

            const statusCounts = employees.reduce((acc, emp) => {
                acc[emp.status] = (acc[emp.status] || 0) + 1;
                return acc;
            }, {});

            const salaryCounts = employees.reduce((acc, emp) => {
                const salaryRange = Math.floor(emp.salario / 1000) * 1000;
                acc[salaryRange] = (acc[salaryRange] || 0) + 1;
                return acc;
            }, {});

            const genderCtx = document.getElementById('gender-distribution-chart').getContext('2d');
            new Chart(genderCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(genderCounts),
                    datasets: [{
                        label: 'Distribuição por Gênero',
                        data: Object.values(genderCounts),
                        backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc'],
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const positionCtx = document.getElementById('position-distribution-chart').getContext('2d');
            new Chart(positionCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(positionCounts),
                    datasets: [{
                        label: 'Distribuição por Cargo',
                        data: Object.values(positionCounts),
                        backgroundColor: '#1cc88a',
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            beginAtZero: true
                        },
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const departmentCtx = document.getElementById('department-distribution-chart').getContext('2d');
            new Chart(departmentCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(departmentCounts),
                    datasets: [{
                        label: 'Distribuição por Departamento',
                        data: Object.values(departmentCounts),
                        backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc', '#f6c23e'],
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const ageCtx = document.getElementById('age-distribution-chart').getContext('2d');
            new Chart(ageCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(ageCounts),
                    datasets: [{
                        label: 'Distribuição por Faixa Etária',
                        data: Object.values(ageCounts),
                        backgroundColor: '#36b9cc',
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            beginAtZero: true
                        },
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const statusCtx = document.getElementById('status-distribution-chart').getContext('2d');
            new Chart(statusCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(statusCounts),
                    datasets: [{
                        label: 'Distribuição por Status',
                        data: Object.values(statusCounts),
                        backgroundColor: ['#1cc88a', '#e74a3b'],
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const salaryCtx = document.getElementById('salary-distribution-chart').getContext('2d');
            new Chart(salaryCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(salaryCounts),
                    datasets: [{
                        label: 'Distribuição por Faixa Salarial',
                        data: Object.values(salaryCounts),
                        backgroundColor: '#f6c23e',
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            beginAtZero: true
                        },
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' funcionários';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        document.getElementById('filter-matricula').addEventListener('input', function () {
            const filterValue = this.value.toLowerCase();
            const rows = document.querySelectorAll('#employee-list tbody tr');

            rows.forEach(row => {
                const matricula = row.cells[1].textContent.toLowerCase();
                if (matricula.includes(filterValue)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        function resetForm() {
            document.getElementById('employee-form').reset();
            document.getElementById('submit-button').style.display = 'block';
            document.getElementById('update-button').style.display = 'none';
            editingEmployeeId = null;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.backgroundColor = type === 'success' ? '#0fbcf9' : '#e74a3b';
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        document.addEventListener('DOMContentLoaded', function () {
            showSection('dashboard-section');
            loadEmployees();
            document.getElementById('employee-form').onsubmit = submitEmployeeForm;
        });
    </script>
</body>

</html>
